scene.map.MapScene=function(){"use strict";var t=function(){this.floor=new domain.map.Floor,this.wall=new domain.map.Wall,this.wall.loadFromObjectList(woList),this.menuButton=$(".menu-button").menuButton($("#map-menu")),this.lifeButton={}},n=t.prototype=new scene.common.Scene;return n.start=function(){var t=this;return pages.common.BackgroundService.turnWhite().then(function(){return t.floor.appear()}).then(function(){return t.wall.appear()}).then(function(){return t.menuButton.show()})},n.fadeOut=function(){this.menuButton.hide();var t=this;return wait().then(function(){return t.floor.disappear()}).then(function(){return pages.common.BackgroundService.turnBlack()})},t}(),domain.map.WallObject=function(){"use strict";var t=function(){},n=t.prototype;return n.setParent=function(t){return this.parent=t,this},n.setPos=function(t){return this.x=t[0],this.y=t[1],this},n.rightLimit=function(){return this.x+this.w},n.setSize=function(t){return this.w=t[0],this.h=t[1],this},n.createDom=function(){return $("<div />").css({backgroundColor:"black",opcaity:0})},n.appear=function(){return this.$dom=this.$dom||this.createDom().width(this.w).height(this.h).offset({left:this.x,top:this.y}).appendTo(this.parent),this.$dom.anim(this.appearAnim,this.appearDur)},n.disappear=function(){var t=this;return this.$dom.anim(this.disappearAnim,this.disappearDur).then(function(){t.$dom.remove()})},t}(),domain.map.Door=function(){"use strict";var t=function(t,n,e){this.name=t,this.star=n,this.score=e};t.createFromObject=function(n){return new t(n.name,n.star,n.score).setPos(n.pos).setSize(n.size)};var n=t.prototype=new domain.map.WallObject;return n.createDom=function(){return $("<div />").addClass("door").css("opcaity",0)},n.appearAnim="door-appear",n.appearDur=400,n.disappearAnim="door-disappear",n.disappearDur=400,t}(),domain.map.Floor=function(){"use strict";var t=400,n=function(){this.$dom=$(".floor")};n.HEIGHT_RATE=.35;var e=n.prototype;return e.appear=function(){return this.$dom.removeClass("floor-hidden"),this.$dom.anim("floor-appear",t)},e.disappear=function(){var n=this;return n.$dom.addClass("floor-hidden"),this.$dom.anim("floor-disappear",t).then(function(){})},n}();var h=100,w=70;window.woList=[{type:"l",name:"0",pos:[100,-h],size:[w,h],star:3,score:5e3},{type:"l",name:"1",pos:[300,-h],size:[w,h],star:3,score:5e3},{type:"l",name:"2",pos:[500,-h],size:[w,h],star:3,score:5e3},{type:"l",name:"3",pos:[700,-h],size:[w,h],star:3,score:5e3}],domain.map.Wall=function(){"use strict";var t=function(){this.wos=[],this.groundLevel=$(window).height()*(1-domain.map.Floor.HEIGHT_RATE),this.$dom=$(".floor-wrapper")},n=t.prototype;return n.loadFromObjectList=function(t){var n=this;this.wos=t.map(function(t){return n.transformCoordinates(t),domain.map.Door.createFromObject(t).setParent(n.$dom)}),this.expandRightLimit(100)},n.transformCoordinates=function(t){t.pos[1]+=this.groundLevel},n.expandRightLimit=function(t){var n=this.rightLimit()+t;$("<div />").appendTo(this.$dom).css({width:"1px",height:"1px",position:"absolute"}).offset({left:n,top:this.groundLevel})},n.rightLimit=function(){return Math.max.apply(Math,this.wos.map(function(t){return t.rightLimit()}))},n.appear=function(){var t=Promise.resolve();return this.wos.forEach(function(n){t=t.then(function(){return n.appear(),wait(100)})}),t},n.disappear=function(){},t}();